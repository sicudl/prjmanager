import{resolveComponent as e,openBlock as t,createBlock as l,withCtx as n,createVNode as i,createTextVNode as a}from"vue";var o={data:()=>({collections:null,selectedProject:null,projects:[],selectedStakeholders:[],stakeholders:[],title:"",body:"",comunicationSent:!1,comunicationError:!1}),methods:{projectChanged:function(e){console.log("Changed")},sendComunication:function(){var e={title:this.title,body:this.body,project_id:this.selectedProject,recipients:this.selectedStakeholders.map((e=>({stakeholders_id:e})))};this.system.api.post("/items/comunication",e).then((e=>{this.title="",this.body="",this.selectedStakeholders=[],this.comunicationSent=!0})).catch((e=>{}))},loadStakeholders:function(e){this.system.api.get("/items/stakeholders?limit=-1&filter[project_id][_eq]="+e).then((e=>{this.selectedStakeholders=[],this.stakeholders=e.data.data}))}},watch:{selectedProject:function(e){this.loadStakeholders(e)}},inject:["system"],mounted(){this.system.api.get("/items/project?limit=-1").then((e=>{if(this.projects=e.data.data,this.$route.query.id){this.projects.find((e=>e.id===parseInt(this.$route.query.id)))&&(this.selectedProject=parseInt(this.$route.query.id))}})),console.log("selectedProject",this.selectedProject)}};const s={class:"form grid with-fill"},d={class:"field full"},r=i("div",{class:"label type-label"},[i("span",null,"Projecte:")],-1),c={class:"field full"},u=i("div",{class:"label type-label"},[i("span",null,"Interessats/des:")],-1),m={class:"field full"},p=i("div",{class:"label type-label"},[i("span",null,"Assumpte:")],-1),f={class:"field full"},h=i("div",{class:"label type-label"},[i("span",null,"Cos:")],-1),v={class:"field full"},y=a("Click me!"),b=i("h2",null,"La comunicació s'ha enviat correctament",-1),g=a("Ok");var j=[],k=[];!function(e,t){if(e&&"undefined"!=typeof document){var l,n=!0===t.prepend?"prepend":"append",i=!0===t.singleTag,a="string"==typeof t.container?document.querySelector(t.container):document.getElementsByTagName("head")[0];if(i){var o=j.indexOf(a);-1===o&&(o=j.push(a)-1,k[o]={}),l=k[o]&&k[o][n]?k[o][n]:k[o][n]=s()}else l=s();65279===e.charCodeAt(0)&&(e=e.substring(1)),l.styleSheet?l.styleSheet.cssText+=e:l.appendChild(document.createTextNode(e))}function s(){var e=document.createElement("style");if(e.setAttribute("type","text/css"),t.attributes)for(var l=Object.keys(t.attributes),i=0;i<l.length;i++)e.setAttribute(l[i],t.attributes[l[i]]);var o="prepend"===n?"afterbegin":"beforeend";return a.insertAdjacentElement(o,e),e}}("\n.form {\n\tdisplay: grid;\n\tpadding: var(--content-padding);\n    padding-bottom: var(--content-padding-bottom);\n\tgap: var(--form-vertical-gap) var(--form-horizontal-gap);\n}\n.with-fill {\n\tgrid-template-columns: [start] minmax(0,var(--form-column-max-width)) [half] minmax(0,var(--form-column-max-width)) [full] 1fr [fill];\n}\n.field {\n\t    position: relative;\n}\n.form .full{\n\tgrid-column: start/full;\n}\n.label {\n    position: relative;\n    display: flex;\n    width: max-content;\n    margin-bottom: 8px;\n    cursor: pointer;\n}\n.type-label {\n    color: var(--foreground-normal-alt);\n    font-weight: 600;\n    font-size: 16px;\n    font-family: var(--family-sans-serif);\n    font-style: normal;\n    line-height: 19px;\n}\n",{}),o.render=function(a,o,j,k,x,S){const V=e("v-select"),C=e("v-input"),_=e("v-textarea"),P=e("v-button"),w=e("v-sheet"),q=e("v-dialog"),A=e("private-view");return t(),l(A,{title:"Envia una comunicació"},{default:n((()=>[i("div",s,[i("div",d,[r,i(V,{"item-text":"name","item-value":"id",modelValue:x.selectedProject,"onUpdate:modelValue":o[1]||(o[1]=e=>x.selectedProject=e),items:x.projects},null,8,["modelValue","items"])]),i("div",c,[u,i(V,{label:"Interessats","item-text":"name","item-value":"id",modelValue:x.selectedStakeholders,"onUpdate:modelValue":o[2]||(o[2]=e=>x.selectedStakeholders=e),multiple:"true",items:x.stakeholders},null,8,["modelValue","items"])]),i("div",m,[p,i(C,{modelValue:x.title,"onUpdate:modelValue":o[3]||(o[3]=e=>x.title=e)},null,8,["modelValue"])]),i("div",f,[h,i(_,{modelValue:x.body,"onUpdate:modelValue":o[4]||(o[4]=e=>x.body=e)},null,8,["modelValue"])]),i("div",v,[i(P,{onClick:S.sendComunication},{default:n((()=>[y])),_:1},8,["onClick"])])]),i(q,{modelValue:x.comunicationSent,"onUpdate:modelValue":o[6]||(o[6]=e=>x.comunicationSent=e)},{default:n((()=>[i(w,null,{default:n((()=>[b,i(P,{onClick:o[5]||(o[5]=e=>x.comunicationSent=!1)},{default:n((()=>[g])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})},o.__file="module.vue";var x={id:"comunications",name:"Comunications",icon:"mail",routes:[{path:"",component:o}]};export{x as default};
